/**
 * 共通エラーメッセージ定義
 *
 * UI全体で一貫したエラーメッセージを提供するための共通モジュール。
 * エラーメッセージを一箇所で管理することで:
 * - 一貫したユーザー体験を提供
 * - メッセージの更新が容易
 * - 重複コードの削減
 */

// ============================================================================
// 共通エラーメッセージ
// ============================================================================

/**
 * 汎用のリトライ促進メッセージ
 */
export const RETRY_MESSAGE = '時間をおいて再度お試しください。'

/**
 * ページリロード促進メッセージ
 */
export const RELOAD_MESSAGE = 'ページを更新して再度お試しください。'

// ============================================================================
// 予約関連エラーメッセージ
// ============================================================================

export const RESERVATION_ERRORS = {
  /** 予約リスト取得失敗 */
  LIST_FETCH_FAILED: `予約リストの取得に失敗しました。${RETRY_MESSAGE}`,
  /** 予約取得失敗 */
  FETCH_FAILED: `予約の取得に失敗しました`,
  /** 予約更新失敗 */
  UPDATE_FAILED: `予約の更新に失敗しました。${RETRY_MESSAGE}`,
  /** 予約送信失敗 */
  SUBMIT_FAILED: `予約の送信に失敗しました。しばらくしてから再度お試しください。`,
  /** 予約作成失敗 */
  CREATE_FAILED: `予約に失敗しました。${RETRY_MESSAGE}`,
  /** 追加予約取得失敗 */
  LOAD_MORE_FAILED: `追加の予約取得に失敗しました。${RETRY_MESSAGE}`,
  /** 最新予約取得失敗 */
  LOAD_PREVIOUS_FAILED: `最新の予約取得に失敗しました。${RETRY_MESSAGE}`,
} as const

// ============================================================================
// スロット・空き状況関連エラーメッセージ
// ============================================================================

export const SLOT_ERRORS = {
  /** 空き状況取得失敗 */
  AVAILABILITY_FETCH_FAILED: `空き状況の取得に失敗しました。${RETRY_MESSAGE}`,
  /** 枠取得失敗 */
  SLOT_FETCH_FAILED: `枠の取得に失敗しました。${RETRY_MESSAGE}`,
  /** 空き枠取得失敗 */
  EMPTY_SLOT_FETCH_FAILED: '空き枠の取得に失敗しました',
  /** スロット競合 - 他の予約あり */
  CONFLICT_ALREADY_RESERVED:
    '申し訳ございません。選択された時間は他のお客様により予約されました。別の時間をお選びください。',
  /** スロット競合 - 過去の時間 */
  CONFLICT_PAST_SLOT: '選択された時間は既に過ぎています。別の時間をお選びください。',
  /** スロット競合 - 検証失敗 */
  CONFLICT_VERIFICATION_FAILED: `空き状況の確認に失敗しました。${RELOAD_MESSAGE}`,
  /** スロット競合 - デフォルト */
  CONFLICT_DEFAULT: '選択された時間は予約できません。別の時間をお選びください。',
} as const

// ============================================================================
// シフト関連エラーメッセージ
// ============================================================================

export const SHIFT_ERRORS = {
  /** シフト情報取得失敗 */
  FETCH_FAILED: 'シフト情報の取得に失敗しました',
  /** シフト作成失敗 */
  CREATE_FAILED: 'シフトの作成に失敗しました',
  /** シフト更新失敗 */
  UPDATE_FAILED: 'シフトの更新に失敗しました',
  /** シフト削除失敗 */
  DELETE_FAILED: 'シフトの削除に失敗しました',
  /** シフト重複 */
  CONFLICT: 'シフトが重複しています',
} as const

// ============================================================================
// 店舗関連エラーメッセージ
// ============================================================================

export const SHOP_ERRORS = {
  /** 店舗情報取得失敗 */
  FETCH_FAILED: '店舗情報の取得に失敗しました',
  /** 店舗一覧取得失敗 */
  LIST_FETCH_FAILED: '店舗一覧の取得に失敗しました',
  /** 店舗詳細取得失敗 */
  DETAIL_FETCH_FAILED: '店舗詳細の取得に失敗しました',
  /** 店舗更新失敗 */
  UPDATE_FAILED: '店舗情報の更新に失敗しました',
} as const

// ============================================================================
// セラピスト関連エラーメッセージ
// ============================================================================

export const THERAPIST_ERRORS = {
  /** セラピスト情報取得失敗 */
  FETCH_FAILED: 'セラピスト情報の取得に失敗しました',
  /** セラピスト一覧取得失敗 */
  LIST_FETCH_FAILED: 'セラピストの取得に失敗しました',
  /** セラピスト更新失敗 */
  UPDATE_FAILED: 'セラピストの更新に失敗しました',
} as const

// ============================================================================
// スタッフ関連エラーメッセージ
// ============================================================================

export const STAFF_ERRORS = {
  /** スタッフ情報取得失敗 */
  FETCH_FAILED: 'スタッフ情報の取得に失敗しました',
  /** スタッフ更新失敗 */
  UPDATE_FAILED: 'スタッフ情報の更新に失敗しました',
  /** スタッフ追加権限なし */
  ADD_FORBIDDEN: 'スタッフを追加する権限がありません（オーナーのみ可能）',
} as const

// ============================================================================
// 通知関連エラーメッセージ
// ============================================================================

export const NOTIFICATION_ERRORS = {
  /** 通知設定取得失敗 */
  FETCH_FAILED: '通知設定の取得に失敗しました',
  /** 通知設定更新失敗 */
  UPDATE_FAILED: '通知設定の更新に失敗しました',
  /** 通知登録失敗 */
  REGISTER_FAILED: '通知の登録に失敗しました。再送信をお試しください。',
  /** 通知再登録失敗 */
  REREGISTER_FAILED: `通知の再登録に失敗しました。${RETRY_MESSAGE}`,
} as const

// ============================================================================
// 口コミ関連エラーメッセージ
// ============================================================================

export const REVIEW_ERRORS = {
  /** 口コミ取得失敗 */
  FETCH_FAILED: '口コミの取得に失敗しました',
  /** 口コミ統計取得失敗 */
  STATS_FETCH_FAILED: '口コミ統計の取得に失敗しました',
  /** 口コミステータス更新失敗 */
  STATUS_UPDATE_FAILED: '口コミのステータス更新に失敗しました',
  /** ステータス更新失敗 (汎用) */
  UPDATE_STATUS_FAILED: 'ステータスの更新に失敗しました',
} as const

// ============================================================================
// 競合エラーメッセージ
// ============================================================================

export const CONFLICT_ERRORS = {
  /** 他ユーザーによる更新競合 */
  OTHER_USER_UPDATED: '他のユーザーによって更新されました。再読み込みしてください。',
  /** 予約時間競合 */
  RESERVATION_TIME_CONFLICT: '他の予約と時間が重複しています。スケジュールをご確認ください。',
} as const

// ============================================================================
// ヘルパー関数
// ============================================================================

/**
 * スロット競合のエラーメッセージを生成する
 */
export function createSlotConflictMessage(reason?: string): string {
  switch (reason) {
    case 'already_reserved':
      return SLOT_ERRORS.CONFLICT_ALREADY_RESERVED
    case 'past_slot':
      return SLOT_ERRORS.CONFLICT_PAST_SLOT
    case 'verification_failed':
      return SLOT_ERRORS.CONFLICT_VERIFICATION_FAILED
    default:
      return SLOT_ERRORS.CONFLICT_DEFAULT
  }
}

/**
 * APIエラーレスポンスからエラーメッセージを抽出する
 */
export function extractErrorMessage(
  error: unknown,
  defaultMessage: string,
): string {
  if (error instanceof Error) {
    return error.message
  }
  if (typeof error === 'object' && error !== null) {
    const obj = error as Record<string, unknown>
    if (typeof obj.message === 'string') return obj.message
    if (typeof obj.detail === 'string') return obj.detail
  }
  return defaultMessage
}
